[SERVICE]
    Daemon    off
    Flush     1
    Log_Level info
    Parsers_File parsers.conf

[INPUT]
    Name              forward
    Listen            0.0.0.0
    Port              24224
    Buffer_Max_Size   1M

[INPUT]
    Name                tail
    Path                /var/lib/docker/containers/*/*.log
    multiline.parser    docker, cri
    Tag                 docker.*
    Refresh_Interval    5
    Buffer_Max_Size     1M

[FILTER]
    Name                parser
    Match               docker.*
    Key_Name            log
    Parser              docker_json
    Reserve_Data        On

[FILTER]
    Name                grep
    Match               docker.*
    Regex               container_name osrs-trading-bot

# Parse structured JSON logs from the bot
[FILTER]
    Name                parser
    Match               docker.*
    Key_Name            log
    Parser              bot_json
    Reserve_Data        On

# Add metadata
[FILTER]
    Name                modify
    Match               docker.*
    Add                 source osrs-flips
    Add                 environment production

# Output to stdout (can be changed to other destinations)
[OUTPUT]
    Name  stdout
    Match *

# Alternative: Output to file
[OUTPUT]
    Name                 file
    Match                docker.*
    Path                 /fluent-bit/log
    File                 osrs-flips.log
    Format               json_lines

# Alternative: Output to Elasticsearch (uncomment and configure)
# [OUTPUT]
#     Name            es
#     Match           docker.*
#     Host            elasticsearch
#     Port            9200
#     Index           osrs-flips-logs
#     Type            _doc

# Alternative: Output to CloudWatch (uncomment and configure)
# [OUTPUT]
#     Name            cloudwatch
#     Match           docker.*
#     region          us-east-1
#     log_group_name  /osrs-flips/logs
#     log_stream_name bot-instance
#     auto_create_group On
